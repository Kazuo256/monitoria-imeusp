
<h1>Controle de frequência</h1>

<h3><%= month_name(@month) %> de <%= @semester.year %></h3>

<table class="table table-hover">
  <thead>
    <tr>
      <th>Monitor(a)</th>
      <th>Disciplina</th>
      <th>Professor(a)</th>
      <th>Presença</th>
    </tr>
  </thead>
  <tbody>
    <% @assistant_roles.each do |role| %>
      <tr>
        <td><%= role.student.name %></td>
        <td><%= role.request_for_teaching_assistant.course.course_code %></td>
        <td><%= role.request_for_teaching_assistant.professor.name %></td>
        <td>
          <% if role.active %>
            <% status = role.frequency_status_for_month(@month) %>
            <% if secretary_signed_in? %>
            <% else # assume professor because of cancan %>
              <% if status == "Pendente" %>
                <div class="col-sm-12 col-lg-6 text-center">
                  <%= button_to "Presente", { controller: "assistant_frequency", action: "mark_generic_assistant_role_frequency", role: role.id, month: @month, presence: true, pid: role.professor.id}, method: :post, class: "btn btn-primary btn-xs", data: { confirm: 'Deseja mesmo marcar presença para este monitor?' } %>
                </div>
                <div class="col-sm-12 col-lg-6 text-center">
                  <%= button_to "Ausente", { controller: "assistant_frequency", action: "mark_generic_assistant_role_frequency", role: role.id, month: @month, presence: false, pid: role.professor.id}, method: :post, class: "btn btn-primary btn-xs", data: { confirm: 'Deseja mesmo marcar ausência para este monitor?' }  %>
                </div>
              <% else %>
                <%= content_tag :span, class: "text-center" do -%>
                  <%= status %>
                <% end %>
              <% end %>
            <% end %>
          <% else %>
            Desativado
          <% end %>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>
